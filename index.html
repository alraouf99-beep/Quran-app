<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ù…ÙŠØ±Ø§Ø« Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ - Ù†Ø³Ø®Ø© Ø§Ù„ÙƒÙ„Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©</title>
    <style>
        :root { --p: #004d40; --g: #c09b52; --bg: #f8faf9; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); padding: 15px; text-align: center; }
        .vortex-container { max-width: 600px; margin: auto; background: white; padding: 25px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 8px solid var(--p); }
        .logic-box { background: #e0f2f1; padding: 10px; border-radius: 10px; font-size: 13px; margin-bottom: 20px; text-align: right; line-height: 1.6; border-right: 5px solid var(--g); }
        .input-group { text-align: right; margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: var(--p); }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 10px; box-sizing: border-box; font-size: 16px; }
        .flex { display: flex; gap: 10px; }
        button { width: 100%; background: var(--p); color: white; padding: 18px; border: none; border-radius: 15px; font-size: 20px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { background: #00695c; }
        #result { margin-top: 25px; padding: 20px; border: 2px solid var(--g); border-radius: 15px; display: none; background: #fff; text-align: right; }
        .res-line { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .val { font-weight: bold; color: #2e7d32; }
        .status-msg { font-size: 12px; color: #666; font-style: italic; margin-top: 5px; }
    </style>
</head>
<body>

<div class="vortex-container">
    <h2>Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ù…ÙŠØ±Ø§Ø« Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ 2026</h2>
    <div class="logic-box">
        â€¢ <b>Ø§Ù„ÙƒÙ„ÙŠÙ„:</b> Ù…Ù† Ù„Ø§ Ø£Ø¨ Ù„Ù‡ ÙˆÙ„Ø§ Ø£Ù… ÙˆÙ„Ø§ ÙˆÙ„Ø¯ (Ø§Ù„Ø²ÙˆØ¬Ø© Ù„Ø§ ØªÙ…Ù†Ø¹ Ø§Ù„ÙƒÙ„Ø§Ù„Ø©).<br>
        â€¢ <b>Ø§Ù„ÙˆÙ„Ø¯:</b> ÙŠØ´Ù…Ù„ Ø§Ù„Ø°ÙƒØ± ÙˆØ§Ù„Ø£Ù†Ø«Ù‰ (Ù‚Ø§Ø¹Ø¯Ø© Ø¹Ø§Ù…Ø©).<br>
        â€¢ <b>Ø§Ù„Ø±Ø¯:</b> Ø§Ù„Ø²ÙˆØ¬Ø© Ù…Ù† Ø§Ù„Ø£Ù‚Ø±Ø¨ÙˆÙ† (ÙŠÙØ±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„ÙØ§Ø¦Ø¶).
    </div>

    <div class="input-group">
        <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø¨Ù„Øº Ø§Ù„ØªØ±ÙƒØ© (MAD):</label>
        <input type="number" id="estate" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº">
    </div>

    <div class="input-group">
        <label>Ø§Ù„Ø¬Ù†Ø³ ÙˆØ§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±:</label>
        <select id="spouseExist">
            <option value="none">Ø£Ø¹Ø²Ø¨ / Ø¹Ø²Ø¨Ø§Ø¡</option>
            <option value="wife">Ø±Ø¬Ù„ ØªØ±Ùƒ Ø²ÙˆØ¬Ø©</option>
            <option value="husband">Ø§Ù…Ø±Ø£Ø© ØªØ±ÙƒØª Ø²ÙˆØ¬Ø§Ù‹</option>
        </select>
    </div>

    <div class="input-group">
        <label>Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡ (Ø§Ù„ÙˆÙ„Ø¯):</label>
        <div class="flex">
            <input type="number" id="sons" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙƒÙˆØ±" value="0" min="0">
            <input type="number" id="daughters" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù†Ø§Ø«" value="0" min="0">
        </div>
        <div class="status-msg">* ÙˆØ¬ÙˆØ¯ ÙˆÙ„Ø¯ ÙŠÙ†ÙÙŠ ØµÙØ© Ø§Ù„ÙƒÙ„Ø§Ù„Ø©.</div>
    </div>

    <div class="input-group">
        <label>Ø§Ù„Ø£Ø¨ÙˆØ§Ù†:</label>
        <div class="flex">
            <select id="father"><option value="0">Ø§Ù„Ø£Ø¨ Ù…ØªÙˆÙÙ‰</option><option value="1">Ø§Ù„Ø£Ø¨ Ø­ÙŠ</option></select>
            <select id="mother"><option value="0">Ø§Ù„Ø£Ù… Ù…ØªÙˆÙØ§Ø©</option><option value="1">Ø§Ù„Ø£Ù… Ø­ÙŠØ©</option></select>
        </div>
        <div class="status-msg">* Ø§Ù„ÙƒÙ„Ø§Ù„Ø© ØªØ´ØªØ±Ø· Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø£Ù… ÙˆØ§Ù„Ø£Ø¨.</div>
    </div>

    <div class="input-group">
        <label>Ø§Ù„Ø¥Ø®ÙˆØ© ÙˆØ§Ù„Ø£Ø®ÙˆØ§Øª (Ù„Ù„Ø¹Ù…Ù„ Ø¨Ù‡ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ø§Ù„Ø©):</label>
        <div class="flex">
            <input type="number" id="mSib" placeholder="Ø°ÙƒÙˆØ±" value="0">
            <input type="number" id="fSib" placeholder="Ø¥Ù†Ø§Ø«" value="0">
        </div>
    </div>

    <button onclick="runVortex()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…ÙŠØ±Ø§Ø« Ø§Ù„Ø¢Ù†</button>
    <div id="result"></div>
</div>

<script>
function runVortex() {
    const estate = parseFloat(document.getElementById('estate').value);
    if (!estate) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº Ø§Ù„ØªØ±ÙƒØ©");

    const sp = document.getElementById('spouseExist').value;
    const nS = parseInt(document.getElementById('sons').value) || 0;
    const nD = parseInt(document.getElementById('daughters').value) || 0;
    const hasW = (nS + nD) > 0; // Ø§Ù„ÙˆÙ„Ø¯ ÙŠØ´Ù…Ù„ Ø§Ù„Ø¬Ù†Ø³ÙŠÙ†
    const hasF = document.getElementById('father').value === "1";
    const hasM = document.getElementById('mother').value === "1";
    const mS = parseInt(document.getElementById('mSib').value) || 0;
    const fS = parseInt(document.getElementById('fSib').value) || 0;

    // ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ø§Ù„Ø© (Ø§Ù„ÙƒÙ„ÙŠÙ„): Ù„Ø§ Ø£Ø¨ ÙˆÙ„Ø§ Ø£Ù… ÙˆÙ„Ø§ ÙˆÙ„Ø¯
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø²ÙˆØ¬Ø©/Ø§Ù„Ø²ÙˆØ¬ Ù„Ø§ ÙŠØ¯Ø®Ù„ÙˆÙ† ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ø±Ø·
    const isKhalala = !hasF && !hasM && !hasW;

    let rates = { spouse: 0, mother: 0, father: 0, children: 0, siblings: 0 };

    // 1. Ù†ØµÙŠØ¨ Ø§Ù„Ø²ÙˆØ¬/Ø§Ù„Ø²ÙˆØ¬Ø©
    if (sp === 'wife') rates.spouse = hasW ? 1/8 : 1/4;
    else if (sp === 'husband') rates.spouse = hasW ? 1/4 : 1/2;

    // 2. ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙŠØ±Ø§Ø« Ø§Ù„Ø¹Ø§Ø¯ÙŠ (Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† ÙƒÙ„ÙŠÙ„Ø§Ù‹)
    if (!isKhalala) {
        if (hasM) rates.mother = hasW ? 1/6 : 1/3;
        if (hasF) rates.father = 1/6; // ÙƒÙØ±Ø¶ Ø£Ø³Ø§Ø³ÙŠ
        if (hasW) rates.children = (nS + nD > 1) ? 2/3 : 1/2;
    } 
    // 3. ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙƒÙ„Ø§Ù„Ø© (Ø§Ù„ÙƒÙ„ÙŠÙ„)
    else {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…ØªÙˆÙÙ‰ Ù…ØªØ²ÙˆØ¬Ø§Ù‹ (Ø±Ø¬Ù„ - Ø¢ÙŠØ© 12)
        if (sp !== 'none') {
            rates.siblings = (mS + fS === 1) ? 1/6 : (mS + fS > 1 ? 1/3 : 0);
        } else { 
            // Ø¥Ø°Ø§ ÙƒØ§Ù† "Ø§Ù…Ø±Ø¤" (Ø¹Ø²Ø¨ - Ø¢ÙŠØ© 176)
            if (mS === 0 && fS === 1) rates.siblings = 1/2;
            else if (mS === 0 && fS >= 2) rates.siblings = 2/3;
            else if (mS > 0) rates.siblings = 0.75; // ØªØ¹ØµÙŠØ¨ (Ù„Ù„Ø°ÙƒØ± Ù…Ø«Ù„ Ø­Ø¸ Ø§Ù„Ø£Ù†Ø«ÙŠÙŠÙ†)
        }
    }

    // 4. Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
    let shares = {};
    for (let key in rates) { shares[key] = estate * rates[key]; }

    // 5. Ù…Ù†Ø·Ù‚ Ø§Ù„Ø±Ø¯ (Ù‚Ø§Ø¹Ø¯Ø©: Ø§Ù„Ø²ÙˆØ¬Ø© Ù…Ù† Ø§Ù„Ø£Ù‚Ø±Ø¨ÙˆÙ†)
    let totalAssigned = Object.values(shares).reduce((a, b) => a + b, 0);
    if (totalAssigned < estate) {
        let surplus = estate - totalAssigned;
        let totalRates = Object.values(rates).reduce((a, b) => a + b, 0);
        
        // ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙØ§Ø¦Ø¶ Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„ÙØ±Ø¶ Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹ (Ø¨Ù…Ø§ ÙÙŠÙ‡Ù… Ø§Ù„Ø²ÙˆØ¬Ø©)
        if (totalRates > 0) {
            for (let key in shares) {
                shares[key] += (rates[key] / totalRates) * surplus;
            }
        }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    let html = `<h4>${isKhalala ? "âš ï¸ Ø­Ø§Ù„Ø© ÙƒÙ„Ø§Ù„Ø© (ÙƒÙ„ÙŠÙ„)" : "ğŸ“‹ Ø­Ø§Ù„Ø© ÙˆØ±Ø§Ø«Ø© Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©"}</h4>`;
    if (shares.spouse > 0) html += `<div class="res-line"><b>Ø§Ù„Ø²ÙˆØ¬/Ø© (Ø´Ø§Ù…Ù„ Ø§Ù„Ø±Ø¯):</b> <span class="val">${shares.spouse.toLocaleString()}</span></div>`;
    if (hasM) html += `<div class="res-line"><b>Ø§Ù„Ø£Ù…:</b> <span class="val">${shares.mother.toLocaleString()}</span></div>`;
    if (hasF) html += `<div class="res-line"><b>Ø§Ù„Ø£Ø¨:</b> <span class="val">${shares.father.toLocaleString()}</span></div>`;
    if (hasW) html += `<div class="res-line"><b>Ø§Ù„Ø£ÙˆÙ„Ø§Ø¯ (${nS+nD}):</b> <span class="val">${shares.children.toLocaleString()}</span></div>`;
    if (shares.siblings > 0) html += `<div class="res-line"><b>Ø§Ù„Ø¥Ø®ÙˆØ©:</b> <span class="val">${shares.siblings.toLocaleString()}</span></div>`;

    document.getElementById('result').innerHTML = html;
    document.getElementById('result').style.display = 'block';
}
</script>

</body>
</html>
